{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useLayoutEffect, useEffect, useCallback, useState } from \"react\";\nimport { GiftedChat } from 'react-native-gifted-chat';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { collection, addDoc, orderBy, query, onSnapshot } from 'firebase/firestore';\nimport { signOut } from 'firebase/auth';\nimport { auth, database } from \"../firebase\";\nimport { useNavigation } from '@react-navigation/native';\nimport GradientBackground from \"../Components/GradientBackground\";\nimport BackButton from \"../Components/BackButton\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function GroupChat(props) {\n  var _auth$currentUser;\n  var navigation = useNavigation();\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    message = _useState2[0],\n    setMessage = _useState2[1];\n  var traveler = props.route.params;\n  console.log(traveler.Picture);\n  var onSignOut = function onSignOut() {\n    signOut(auth).catch(function (error) {\n      return console.log(error);\n    });\n  };\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      headerRight: function headerRight() {\n        return _jsx(TouchableOpacity, {\n          style: {\n            marginRight: 10\n          },\n          onPress: onSignOut,\n          children: _jsx(Text, {\n            children: \" Hi\"\n          })\n        });\n      }\n    });\n  }, [navigation]);\n  useLayoutEffect(function () {\n    var collectionRef = collection(database, 'chats');\n    var q = query(collectionRef, orderBy('createdAt', 'desc'));\n    var unsubscribe = onSnapshot(q, function (snapshot) {\n      console.log('snapshot');\n      setMessage(snapshot.docs.map(function (doc) {\n        return {\n          _id: doc.id,\n          createdAt: doc.data().createdAt.toDate(),\n          text: doc.data().text,\n          user: doc.data().user\n        };\n      }));\n    });\n    return function () {\n      return unsubscribe();\n    };\n  }, []);\n  var _onSend = useCallback(function () {\n    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    setMessage(function (prevmesseg) {\n      return GiftedChat.append(prevmesseg, message);\n    });\n    var _message$ = message[0],\n      _id = _message$._id,\n      createdAt = _message$.createdAt,\n      text = _message$.text,\n      user = _message$.user;\n    addDoc(collection(database, 'chats'), {\n      _id: _id,\n      createdAt: createdAt,\n      text: text,\n      user: user\n    });\n  }, []);\n  return _jsx(View, {\n    style: styles.container,\n    children: _jsxs(GradientBackground, {\n      children: [_jsx(BackButton, {}), _jsx(GiftedChat, {\n        showAvatarForEveryMessage: true,\n        messages: message,\n        onSend: function onSend(message) {\n          return _onSend(message);\n        },\n        user: {\n          _id: auth == null ? void 0 : (_auth$currentUser = auth.currentUser) == null ? void 0 : _auth$currentUser.email,\n          avatar: traveler.Picture\n        }\n      })]\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    marginTop: 40,\n    marginBottom: 30\n  }\n});","map":{"version":3,"names":["React","useLayoutEffect","useEffect","useCallback","useState","GiftedChat","StyleSheet","Text","View","TouchableOpacity","collection","addDoc","orderBy","query","onSnapshot","signOut","auth","database","useNavigation","GradientBackground","BackButton","jsx","_jsx","jsxs","_jsxs","GroupChat","props","_auth$currentUser","navigation","_useState","_useState2","_slicedToArray","message","setMessage","traveler","route","params","console","log","Picture","onSignOut","catch","error","setOptions","headerRight","style","marginRight","onPress","children","collectionRef","q","unsubscribe","snapshot","docs","map","doc","_id","id","createdAt","data","toDate","text","user","onSend","arguments","length","undefined","prevmesseg","append","_message$","styles","container","showAvatarForEveryMessage","messages","currentUser","email","avatar","create","flex","backgroundColor","marginTop","marginBottom"],"sources":["C:/Users/97250/Desktop/פרויקט גמר/roadranger_1/client/travelersSide/Screens/GroupChat.jsx"],"sourcesContent":["import React, { useLayoutEffect, useEffect, useCallback, useState } from \"react\";\r\nimport { GiftedChat } from 'react-native-gifted-chat'\r\nimport { StyleSheet, Text, View, TouchableOpacity } from 'react-native';\r\nimport { collection, addDoc, orderBy, query, onSnapshot } from 'firebase/firestore'\r\nimport { signOut } from 'firebase/auth'\r\nimport { auth, database } from '../firebase'\r\nimport { useNavigation } from '@react-navigation/native'\r\nimport GradientBackground from '../Components/GradientBackground';\r\nimport BackButton from \"../Components/BackButton\";\r\n\r\n\r\n\r\nexport default function GroupChat(props) {\r\n    const navigation = useNavigation();\r\n    const [message, setMessage] = useState([]);\r\n\r\nconst traveler = props.route.params;\r\nconsole.log(traveler.Picture)\r\n    const onSignOut = () => {\r\n        signOut(auth).catch(error => console.log(error));\r\n    };\r\n\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({\r\n            headerRight: () => (\r\n                <TouchableOpacity style={{ marginRight: 10 }} onPress={onSignOut}>\r\n                    <Text> Hi</Text>\r\n                </TouchableOpacity>\r\n            )\r\n        });\r\n    }, [navigation]);\r\n\r\n    useLayoutEffect(() => {\r\n        const collectionRef = collection(database, 'chats');\r\n        const q = query(collectionRef,orderBy('createdAt', 'desc'));\r\n        const unsubscribe = onSnapshot(q, snapshot => {\r\n            console.log('snapshot');\r\n            setMessage(\r\n                snapshot.docs.map(doc => ({\r\n                    _id: doc.id,\r\n                    createdAt: doc.data().createdAt.toDate(),\r\n                    text: doc.data().text,\r\n                    user: doc.data().user\r\n                }))\r\n            )\r\n        });\r\n        return () => unsubscribe();\r\n    },[]);\r\n\r\n    \r\n    const onSend= useCallback((message=[])=>{\r\n        setMessage(prevmesseg => GiftedChat.append(prevmesseg,message));\r\n        const {_id,createdAt, text, user}= message[0];\r\n        addDoc(collection(database,'chats'),{\r\n            _id,\r\n            createdAt,\r\n            text,\r\n            user\r\n        });\r\n    },[])\r\n    return (\r\n        <View style={styles.container}>\r\n            <GradientBackground>\r\n            <BackButton />\r\n            <GiftedChat \r\n            showAvatarForEveryMessage={true}\r\n            messages={message}\r\n            onSend={message => onSend(message)}\r\n            user={{\r\n                _id: auth?.currentUser?.email,\r\n                avatar: traveler.Picture\r\n            }}\r\n            // messagesContainerStyle={{\r\n\r\n            // }}\r\n            />\r\n            </GradientBackground>\r\n        </View>\r\n    )\r\n}\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        backgroundColor: '#fff',\r\n        marginTop: 40,\r\n        marginBottom: 30\r\n    }\r\n})"],"mappings":"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"},"metadata":{},"sourceType":"module"}