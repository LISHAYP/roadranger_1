{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _excluded = [\"messages\", \"user\", \"inverted\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport { LoadEarlier } from \"./LoadEarlier\";\nimport Message from \"./Message\";\nimport Color from \"./Color\";\nimport TypingIndicator from \"./TypingIndicator\";\nimport { StylePropType } from \"./utils\";\nimport { warning } from \"./logging\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  containerAlignTop: {\n    flexDirection: 'row',\n    alignItems: 'flex-start'\n  },\n  contentContainerStyle: {\n    flexGrow: 1,\n    justifyContent: 'flex-start'\n  },\n  emptyChatContainer: {\n    flex: 1,\n    transform: [{\n      scaleY: -1\n    }]\n  },\n  headerWrapper: {\n    flex: 1\n  },\n  listStyle: {\n    flex: 1\n  },\n  scrollToBottomStyle: {\n    opacity: 0.8,\n    position: 'absolute',\n    right: 10,\n    bottom: 30,\n    zIndex: 999,\n    height: 40,\n    width: 40,\n    borderRadius: 20,\n    backgroundColor: Color.white,\n    alignItems: 'center',\n    justifyContent: 'center',\n    shadowColor: Color.black,\n    shadowOpacity: 0.5,\n    shadowOffset: {\n      width: 0,\n      height: 0\n    },\n    shadowRadius: 1\n  }\n});\nvar MessageContainer = function (_React$PureComponent) {\n  _inherits(MessageContainer, _React$PureComponent);\n  var _super = _createSuper(MessageContainer);\n  function MessageContainer() {\n    var _this;\n    _classCallCheck(this, MessageContainer);\n    _this = _super.apply(this, arguments);\n    _this.state = {\n      showScrollBottom: false,\n      hasScrolled: false\n    };\n    _this.renderTypingIndicator = function () {\n      if (Platform.OS === 'web') {\n        return null;\n      }\n      return _jsx(TypingIndicator, {\n        isTyping: _this.props.isTyping || false\n      });\n    };\n    _this.renderFooter = function () {\n      if (_this.props.renderFooter) {\n        return _this.props.renderFooter(_this.props);\n      }\n      return _this.renderTypingIndicator();\n    };\n    _this.renderLoadEarlier = function () {\n      if (_this.props.loadEarlier === true) {\n        var loadEarlierProps = _objectSpread({}, _this.props);\n        if (_this.props.renderLoadEarlier) {\n          return _this.props.renderLoadEarlier(loadEarlierProps);\n        }\n        return _jsx(LoadEarlier, _objectSpread({}, loadEarlierProps));\n      }\n      return null;\n    };\n    _this.scrollToBottom = function () {\n      var animated = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var inverted = _this.props.inverted;\n      if (inverted) {\n        _this.scrollTo({\n          offset: 0,\n          animated: animated\n        });\n      } else if (_this.props.forwardRef && _this.props.forwardRef.current) {\n        _this.props.forwardRef.current.scrollToEnd({\n          animated: animated\n        });\n      }\n    };\n    _this.handleOnScroll = function (event) {\n      var _event$nativeEvent = event.nativeEvent,\n        contentOffsetY = _event$nativeEvent.contentOffset.y,\n        contentSizeHeight = _event$nativeEvent.contentSize.height,\n        layoutMeasurementHeight = _event$nativeEvent.layoutMeasurement.height;\n      var scrollToBottomOffset = _this.props.scrollToBottomOffset;\n      if (_this.props.inverted) {\n        if (contentOffsetY > scrollToBottomOffset) {\n          _this.setState({\n            showScrollBottom: true,\n            hasScrolled: true\n          });\n        } else {\n          _this.setState({\n            showScrollBottom: false,\n            hasScrolled: true\n          });\n        }\n      } else {\n        if (contentOffsetY < scrollToBottomOffset && contentSizeHeight - layoutMeasurementHeight > scrollToBottomOffset) {\n          _this.setState({\n            showScrollBottom: true,\n            hasScrolled: true\n          });\n        } else {\n          _this.setState({\n            showScrollBottom: false,\n            hasScrolled: true\n          });\n        }\n      }\n    };\n    _this.renderRow = function (_ref) {\n      var item = _ref.item,\n        index = _ref.index;\n      if (!item._id && item._id !== 0) {\n        warning('GiftedChat: `_id` is missing for message', JSON.stringify(item));\n      }\n      if (!item.user) {\n        if (!item.system) {\n          warning('GiftedChat: `user` is missing for message', JSON.stringify(item));\n        }\n        item.user = {\n          _id: 0\n        };\n      }\n      var _this$props = _this.props,\n        messages = _this$props.messages,\n        user = _this$props.user,\n        inverted = _this$props.inverted,\n        restProps = _objectWithoutProperties(_this$props, _excluded);\n      if (messages && user) {\n        var previousMessage = (inverted ? messages[index + 1] : messages[index - 1]) || {};\n        var nextMessage = (inverted ? messages[index - 1] : messages[index + 1]) || {};\n        var messageProps = _objectSpread(_objectSpread({}, restProps), {}, {\n          user: user,\n          key: item._id,\n          currentMessage: item,\n          previousMessage: previousMessage,\n          inverted: inverted,\n          nextMessage: nextMessage,\n          position: item.user._id === user._id ? 'right' : 'left'\n        });\n        if (_this.props.renderMessage) {\n          return _this.props.renderMessage(messageProps);\n        }\n        return _jsx(Message, _objectSpread({}, messageProps));\n      }\n      return null;\n    };\n    _this.renderChatEmpty = function () {\n      if (_this.props.renderChatEmpty) {\n        return _this.props.inverted ? _this.props.renderChatEmpty() : _jsx(View, {\n          style: styles.emptyChatContainer,\n          children: _this.props.renderChatEmpty()\n        });\n      }\n      return _jsx(View, {\n        style: styles.container\n      });\n    };\n    _this.renderHeaderWrapper = function () {\n      return _jsx(View, {\n        style: styles.headerWrapper,\n        children: _this.renderLoadEarlier()\n      });\n    };\n    _this.onLayoutList = function () {\n      if (!_this.props.inverted && !!_this.props.messages && _this.props.messages.length) {\n        setTimeout(function () {\n          return _this.scrollToBottom && _this.scrollToBottom(false);\n        }, 15 * _this.props.messages.length);\n      }\n    };\n    _this.onEndReached = function (_ref2) {\n      var distanceFromEnd = _ref2.distanceFromEnd;\n      var _this$props2 = _this.props,\n        loadEarlier = _this$props2.loadEarlier,\n        onLoadEarlier = _this$props2.onLoadEarlier,\n        infiniteScroll = _this$props2.infiniteScroll,\n        isLoadingEarlier = _this$props2.isLoadingEarlier;\n      if (infiniteScroll && (_this.state.hasScrolled || distanceFromEnd > 0) && distanceFromEnd <= 100 && loadEarlier && onLoadEarlier && !isLoadingEarlier && Platform.OS !== 'web') {\n        onLoadEarlier();\n      }\n    };\n    _this.keyExtractor = function (item) {\n      return \"\" + item._id;\n    };\n    return _this;\n  }\n  _createClass(MessageContainer, [{\n    key: \"scrollTo\",\n    value: function scrollTo(options) {\n      if (this.props.forwardRef && this.props.forwardRef.current && options) {\n        this.props.forwardRef.current.scrollToOffset(options);\n      }\n    }\n  }, {\n    key: \"renderScrollBottomComponent\",\n    value: function renderScrollBottomComponent() {\n      var scrollToBottomComponent = this.props.scrollToBottomComponent;\n      if (scrollToBottomComponent) {\n        return scrollToBottomComponent();\n      }\n      return _jsx(Text, {\n        children: \"V\"\n      });\n    }\n  }, {\n    key: \"renderScrollToBottomWrapper\",\n    value: function renderScrollToBottomWrapper() {\n      var _this2 = this;\n      var propsStyle = this.props.scrollToBottomStyle || {};\n      return _jsx(View, {\n        style: [styles.scrollToBottomStyle, propsStyle],\n        children: _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return _this2.scrollToBottom();\n          },\n          hitSlop: {\n            top: 5,\n            left: 5,\n            right: 5,\n            bottom: 5\n          },\n          children: this.renderScrollBottomComponent()\n        })\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var inverted = this.props.inverted;\n      return _jsxs(View, {\n        style: this.props.alignTop ? styles.containerAlignTop : styles.container,\n        children: [_jsx(FlatList, _objectSpread(_objectSpread({\n          ref: this.props.forwardRef,\n          extraData: [this.props.extraData, this.props.isTyping],\n          keyExtractor: this.keyExtractor,\n          enableEmptySections: true,\n          automaticallyAdjustContentInsets: false,\n          inverted: inverted,\n          data: this.props.messages,\n          style: styles.listStyle,\n          contentContainerStyle: styles.contentContainerStyle,\n          renderItem: this.renderRow\n        }, this.props.invertibleScrollViewProps), {}, {\n          ListEmptyComponent: this.renderChatEmpty,\n          ListFooterComponent: inverted ? this.renderHeaderWrapper : this.renderFooter,\n          ListHeaderComponent: inverted ? this.renderFooter : this.renderHeaderWrapper,\n          onScroll: this.handleOnScroll,\n          scrollEventThrottle: 100,\n          onLayout: this.onLayoutList,\n          onEndReached: this.onEndReached,\n          onEndReachedThreshold: 0.1\n        }, this.props.listViewProps)), this.state.showScrollBottom && this.props.scrollToBottom ? this.renderScrollToBottomWrapper() : null]\n      });\n    }\n  }]);\n  return MessageContainer;\n}(React.PureComponent);\nexport { MessageContainer as default };\nMessageContainer.defaultProps = {\n  messages: [],\n  user: {},\n  isTyping: false,\n  renderChatEmpty: null,\n  renderFooter: null,\n  renderMessage: null,\n  onLoadEarlier: function onLoadEarlier() {},\n  onQuickReply: function onQuickReply() {},\n  inverted: true,\n  loadEarlier: false,\n  listViewProps: {},\n  invertibleScrollViewProps: {},\n  extraData: null,\n  scrollToBottom: false,\n  scrollToBottomOffset: 200,\n  alignTop: false,\n  scrollToBottomStyle: {},\n  infiniteScroll: false,\n  isLoadingEarlier: false\n};\nMessageContainer.propTypes = {\n  messages: PropTypes.arrayOf(PropTypes.object),\n  isTyping: PropTypes.bool,\n  user: PropTypes.object,\n  renderChatEmpty: PropTypes.func,\n  renderFooter: PropTypes.func,\n  renderMessage: PropTypes.func,\n  renderLoadEarlier: PropTypes.func,\n  onLoadEarlier: PropTypes.func,\n  listViewProps: PropTypes.object,\n  inverted: PropTypes.bool,\n  loadEarlier: PropTypes.bool,\n  invertibleScrollViewProps: PropTypes.object,\n  extraData: PropTypes.object,\n  scrollToBottom: PropTypes.bool,\n  scrollToBottomOffset: PropTypes.number,\n  scrollToBottomComponent: PropTypes.func,\n  alignTop: PropTypes.bool,\n  scrollToBottomStyle: StylePropType,\n  infiniteScroll: PropTypes.bool\n};","map":{"version":3,"sources":["../src/MessageContainer.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import PropTypes from 'prop-types';\nimport React from 'react';\nimport { FlatList, View, StyleSheet, TouchableOpacity, Text, Platform, } from 'react-native';\nimport { LoadEarlier } from './LoadEarlier';\nimport Message from './Message';\nimport Color from './Color';\nimport TypingIndicator from './TypingIndicator';\nimport { StylePropType } from './utils';\nimport { warning } from './logging';\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n    },\n    containerAlignTop: {\n        flexDirection: 'row',\n        alignItems: 'flex-start',\n    },\n    contentContainerStyle: {\n        flexGrow: 1,\n        justifyContent: 'flex-start',\n    },\n    emptyChatContainer: {\n        flex: 1,\n        transform: [{ scaleY: -1 }],\n    },\n    headerWrapper: {\n        flex: 1,\n    },\n    listStyle: {\n        flex: 1,\n    },\n    scrollToBottomStyle: {\n        opacity: 0.8,\n        position: 'absolute',\n        right: 10,\n        bottom: 30,\n        zIndex: 999,\n        height: 40,\n        width: 40,\n        borderRadius: 20,\n        backgroundColor: Color.white,\n        alignItems: 'center',\n        justifyContent: 'center',\n        shadowColor: Color.black,\n        shadowOpacity: 0.5,\n        shadowOffset: { width: 0, height: 0 },\n        shadowRadius: 1,\n    },\n});\nexport default class MessageContainer extends React.PureComponent {\n    constructor() {\n        super(...arguments);\n        this.state = {\n            showScrollBottom: false,\n            hasScrolled: false,\n        };\n        this.renderTypingIndicator = () => {\n            if (Platform.OS === 'web') {\n                return null;\n            }\n            return <TypingIndicator isTyping={this.props.isTyping || false}/>;\n        };\n        this.renderFooter = () => {\n            if (this.props.renderFooter) {\n                return this.props.renderFooter(this.props);\n            }\n            return this.renderTypingIndicator();\n        };\n        this.renderLoadEarlier = () => {\n            if (this.props.loadEarlier === true) {\n                const loadEarlierProps = {\n                    ...this.props,\n                };\n                if (this.props.renderLoadEarlier) {\n                    return this.props.renderLoadEarlier(loadEarlierProps);\n                }\n                return <LoadEarlier {...loadEarlierProps}/>;\n            }\n            return null;\n        };\n        this.scrollToBottom = (animated = true) => {\n            const { inverted } = this.props;\n            if (inverted) {\n                this.scrollTo({ offset: 0, animated });\n            }\n            else if (this.props.forwardRef && this.props.forwardRef.current) {\n                this.props.forwardRef.current.scrollToEnd({ animated });\n            }\n        };\n        this.handleOnScroll = (event) => {\n            const { nativeEvent: { contentOffset: { y: contentOffsetY }, contentSize: { height: contentSizeHeight }, layoutMeasurement: { height: layoutMeasurementHeight }, }, } = event;\n            const { scrollToBottomOffset } = this.props;\n            if (this.props.inverted) {\n                if (contentOffsetY > scrollToBottomOffset) {\n                    this.setState({ showScrollBottom: true, hasScrolled: true });\n                }\n                else {\n                    this.setState({ showScrollBottom: false, hasScrolled: true });\n                }\n            }\n            else {\n                if (contentOffsetY < scrollToBottomOffset &&\n                    contentSizeHeight - layoutMeasurementHeight > scrollToBottomOffset) {\n                    this.setState({ showScrollBottom: true, hasScrolled: true });\n                }\n                else {\n                    this.setState({ showScrollBottom: false, hasScrolled: true });\n                }\n            }\n        };\n        this.renderRow = ({ item, index }) => {\n            if (!item._id && item._id !== 0) {\n                warning('GiftedChat: `_id` is missing for message', JSON.stringify(item));\n            }\n            if (!item.user) {\n                if (!item.system) {\n                    warning('GiftedChat: `user` is missing for message', JSON.stringify(item));\n                }\n                item.user = { _id: 0 };\n            }\n            const { messages, user, inverted, ...restProps } = this.props;\n            if (messages && user) {\n                const previousMessage = (inverted ? messages[index + 1] : messages[index - 1]) || {};\n                const nextMessage = (inverted ? messages[index - 1] : messages[index + 1]) || {};\n                const messageProps = {\n                    ...restProps,\n                    user,\n                    key: item._id,\n                    currentMessage: item,\n                    previousMessage,\n                    inverted,\n                    nextMessage,\n                    position: item.user._id === user._id ? 'right' : 'left',\n                };\n                if (this.props.renderMessage) {\n                    return this.props.renderMessage(messageProps);\n                }\n                return <Message {...messageProps}/>;\n            }\n            return null;\n        };\n        this.renderChatEmpty = () => {\n            if (this.props.renderChatEmpty) {\n                return this.props.inverted ? (this.props.renderChatEmpty()) : (<View style={styles.emptyChatContainer}>\n          {this.props.renderChatEmpty()}\n        </View>);\n            }\n            return <View style={styles.container}/>;\n        };\n        this.renderHeaderWrapper = () => (<View style={styles.headerWrapper}>{this.renderLoadEarlier()}</View>);\n        this.onLayoutList = () => {\n            if (!this.props.inverted &&\n                !!this.props.messages &&\n                this.props.messages.length) {\n                setTimeout(() => this.scrollToBottom && this.scrollToBottom(false), 15 * this.props.messages.length);\n            }\n        };\n        this.onEndReached = ({ distanceFromEnd }) => {\n            const { loadEarlier, onLoadEarlier, infiniteScroll, isLoadingEarlier, } = this.props;\n            if (infiniteScroll &&\n                (this.state.hasScrolled || distanceFromEnd > 0) &&\n                distanceFromEnd <= 100 &&\n                loadEarlier &&\n                onLoadEarlier &&\n                !isLoadingEarlier &&\n                Platform.OS !== 'web') {\n                onLoadEarlier();\n            }\n        };\n        this.keyExtractor = (item) => `${item._id}`;\n    }\n    scrollTo(options) {\n        if (this.props.forwardRef && this.props.forwardRef.current && options) {\n            this.props.forwardRef.current.scrollToOffset(options);\n        }\n    }\n    renderScrollBottomComponent() {\n        const { scrollToBottomComponent } = this.props;\n        if (scrollToBottomComponent) {\n            return scrollToBottomComponent();\n        }\n        return <Text>V</Text>;\n    }\n    renderScrollToBottomWrapper() {\n        const propsStyle = this.props.scrollToBottomStyle || {};\n        return (<View style={[styles.scrollToBottomStyle, propsStyle]}>\n        <TouchableOpacity onPress={() => this.scrollToBottom()} hitSlop={{ top: 5, left: 5, right: 5, bottom: 5 }}>\n          {this.renderScrollBottomComponent()}\n        </TouchableOpacity>\n      </View>);\n    }\n    render() {\n        const { inverted } = this.props;\n        return (<View style={this.props.alignTop ? styles.containerAlignTop : styles.container}>\n        <FlatList ref={this.props.forwardRef} extraData={[this.props.extraData, this.props.isTyping]} keyExtractor={this.keyExtractor} enableEmptySections automaticallyAdjustContentInsets={false} inverted={inverted} data={this.props.messages} style={styles.listStyle} contentContainerStyle={styles.contentContainerStyle} renderItem={this.renderRow} {...this.props.invertibleScrollViewProps} ListEmptyComponent={this.renderChatEmpty} ListFooterComponent={inverted ? this.renderHeaderWrapper : this.renderFooter} ListHeaderComponent={inverted ? this.renderFooter : this.renderHeaderWrapper} onScroll={this.handleOnScroll} scrollEventThrottle={100} onLayout={this.onLayoutList} onEndReached={this.onEndReached} onEndReachedThreshold={0.1} {...this.props.listViewProps}/>\n        {this.state.showScrollBottom && this.props.scrollToBottom\n                ? this.renderScrollToBottomWrapper()\n                : null}\n      </View>);\n    }\n}\nMessageContainer.defaultProps = {\n    messages: [],\n    user: {},\n    isTyping: false,\n    renderChatEmpty: null,\n    renderFooter: null,\n    renderMessage: null,\n    onLoadEarlier: () => { },\n    onQuickReply: () => { },\n    inverted: true,\n    loadEarlier: false,\n    listViewProps: {},\n    invertibleScrollViewProps: {},\n    extraData: null,\n    scrollToBottom: false,\n    scrollToBottomOffset: 200,\n    alignTop: false,\n    scrollToBottomStyle: {},\n    infiniteScroll: false,\n    isLoadingEarlier: false,\n};\nMessageContainer.propTypes = {\n    messages: PropTypes.arrayOf(PropTypes.object),\n    isTyping: PropTypes.bool,\n    user: PropTypes.object,\n    renderChatEmpty: PropTypes.func,\n    renderFooter: PropTypes.func,\n    renderMessage: PropTypes.func,\n    renderLoadEarlier: PropTypes.func,\n    onLoadEarlier: PropTypes.func,\n    listViewProps: PropTypes.object,\n    inverted: PropTypes.bool,\n    loadEarlier: PropTypes.bool,\n    invertibleScrollViewProps: PropTypes.object,\n    extraData: PropTypes.object,\n    scrollToBottom: PropTypes.bool,\n    scrollToBottomOffset: PropTypes.number,\n    scrollToBottomComponent: PropTypes.func,\n    alignTop: PropTypes.bool,\n    scrollToBottomStyle: StylePropType,\n    infiniteScroll: PropTypes.bool,\n};\n//# sourceMappingURL=MessageContainer.js.map"]},"metadata":{},"sourceType":"module"}